.. _flatdiv:

flatdiv: Divide spectra by flat field
=====================================

**Package: irs**

.. raw:: html

  <section id="s_usage">
  <h3>Usage</h3>
  <p>
  flatdiv input records
  </p>
  </section>
  <section id="s_parameters">
  <h3>Parameters</h3>
  <dl id="l_input">
  <dt><b>input</b></dt>
  <!-- Sec='PARAMETERS' Level=0 Label='input' Line='input' -->
  <dd>The root file name for the input records to be divided.
  </dd>
  </dl>
  <dl id="l_records">
  <dt><b>records</b></dt>
  <!-- Sec='PARAMETERS' Level=0 Label='records' Line='records' -->
  <dd>The range of spectra to be included in the divide operation.
  Each range item will be appended to the root name to form an
  image file name.
  </dd>
  </dl>
  <dl id="l_output">
  <dt><b>output</b></dt>
  <!-- Sec='PARAMETERS' Level=0 Label='output' Line='output' -->
  <dd>New spectra are created by the flatdiv operation. This parameter
  specifies the root name to be used for the created spectra.
  </dd>
  </dl>
  <dl id="l_start_rec">
  <dt><b>start_rec</b></dt>
  <!-- Sec='PARAMETERS' Level=0 Label='start_rec' Line='start_rec' -->
  <dd>Each new spectrum created as <span style="font-family: monospace;">"output"</span> has its root name and a 
  trailing number appended starting with <span style="font-family: monospace;">"start_rec"</span>. Subsequent
  output images will have an incremented trailing number.
  Note that even if an output image is not created because the input
  image has already been flattened or the input image is not found the
  output record number is still incremented.
  </dd>
  </dl>
  <dl id="l_flat_file">
  <dt><b>flat_file</b></dt>
  <!-- Sec='PARAMETERS' Level=0 Label='flat_file' Line='flat_file' -->
  <dd>The root name for the sensitivity spectra as produced by FLATFIT.
  Normally with multi-aperture instruments, FLATFIT will produce a
  spectrum appropriate to each aperture and the file name will have
  <span style="font-family: monospace;">"flat_file"</span> as the file name root and the aperture number appended.
  </dd>
  </dl>
  <dl id="l_coincor">
  <dt><b>coincor = )_.coincor</b></dt>
  <!-- Sec='PARAMETERS' Level=0 Label='coincor' Line='coincor = )_.coincor' -->
  <dd>If set to yes, coincidence correction is applied to the data during
  the division, and the following three parameters are required.
  For more about this correction see <b>coincor</b>.
  <dl>
  <dt><b>ccmode = )_.ccmode</b></dt>
  <!-- Sec='PARAMETERS' Level=1 Label='ccmode' Line='ccmode = )_.ccmode' -->
  <dd>The mode by which the coincidence correction is to be performed.
  This may be <span style="font-family: monospace;">"iids"</span> or <span style="font-family: monospace;">"photo"</span>.
  </dd>
  </dl>
  <dl>
  <dt><b>deadtime = )_.deadtime</b></dt>
  <!-- Sec='PARAMETERS' Level=1 Label='deadtime' Line='deadtime = )_.deadtime' -->
  <dd>The detector deadtime in seconds.
  </dd>
  </dl>
  <dl>
  <dt><b>power = )_.power</b></dt>
  <!-- Sec='PARAMETERS' Level=1 Label='power' Line='power = )_.power' -->
  <dd>Power law IIDS non-linear correction exponent.
  </dd>
  </dl>
  </dd>
  </dl>
  </section>
  <section id="s_description">
  <h3>Description</h3>
  <p>
  The input spectra are divided by the flat fields which are
  represented by spectra produced by FLATFIT.
  </p>
  <p>
  To avoid possible division by zero, any zeroes in the flat field
  spectra generated by FLATFIT are replaced by 1.0.
  </p>
  <p>
  The input spectra may optionally be corrected for coincidence losses.
  </p>
  <p>
  If the input and output spectra (after appending the record numbers) are
  the same then the division is performed in-place; i.e. the flattened spectra
  replace the original input spectra.
  Note that even if an output image is not created because the input
  image has already been flattened or the input image is not found the
  output record number is still incremented.  This is to insure that if
  in-place division is desired that the input and output names remain
  matched.
  </p>
  </section>
  <section id="s_examples">
  <h3>Examples</h3>
  <p>
  The following example divides a series of spectra to produce 20 new
  spectra having names nite1.1221 ... nite1.1240.
  </p>
  <div class="highlight-default-notranslate"><pre>
  cl&gt; flatdiv nite1 1201-1220 nite1 1221
  </pre></div>
  <p>
  The same spectra as above are simultaneously corrected for
  coincidence losses.
  </p>
  <div class="highlight-default-notranslate"><pre>
  cl&gt; flatdiv nite1 1201-1220 nite1 1221 coincor=yes
  </pre></div>
  <p>
  The flattened spectra replace the unflattened spectra.
  </p>
  <div class="highlight-default-notranslate"><pre>
  cl&gt; flatdiv nite1 1201-1220 nite1 1201
  </pre></div>
  <p>
  Note that the input record numbers must be contiguous and the starting
  output record number must be the same as the first input record number.
  </p>
  </section>
  <section id="s_time_requirements">
  <h3>Time requirements</h3>
  <p>
  Approximately 1 second is required to correct a spectrum of length
  1024 points.
  </p>
  </section>
  <section id="s_see_also">
  <h3>See also</h3>
  <p>
  coincor, flatfit
  </p>
  
  </section>
  
  <!-- Contents: 'NAME' 'USAGE' 'PARAMETERS' 'DESCRIPTION' 'EXAMPLES' 'TIME REQUIREMENTS' 'SEE ALSO'  -->
  
